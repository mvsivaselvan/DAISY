#include<stdio.h>
#include<stdlib.h>

#include "SplineApproximation.h"

void main()
{
	emxArray_real_T gamm_, J_, xg, wg, colmat, P0;

	double gamm_data[] = { -60.6380, 0, -105.0282, -58.8579, 0, -106.0342, -52.6194, 0, -109.2652,  -46.2036, 0, -112.1283,
                           -42.3973, 0, -113.6231, -35.7463, 0, -115.8866, -28.9759, 0, -117.7634,  -24.9891, 0, -118.6726,
                           -18.0751, 0, -119.9202, -11.1005, 0, -120.7657,  -7.0227, 0, -121.0709,   -0.0000, 0, -121.2761,
	                         7.0227, 0, -121.0709,  11.1005, 0, -120.7657,  18.0751, 0, -119.9202,   24.9891, 0, -118.6726,
                            28.9759, 0, -117.7634,  35.7463, 0, -115.8866,  42.3973, 0, -113.6231,   46.2036, 0, -112.1283,
                            52.6194, 0, -109.2652,  58.8579, 0, -106.0342,  60.6380, 0, -105.0282 };
	int gamm_size[] = { 3,23 };
	gamm_.data = gamm_data;
	gamm_.size = gamm_size;
	gamm_.allocatedSize = 69;
	gamm_.numDimensions = 2;
	gamm_.canFreeData = false;

	double J_data[23];
	for (int i = 0; i < 23; i++)
		J_data[i] = 126.9994;
	int J_size[] = { 23 };
	J_.data = J_data;
	J_.size = J_size;
	J_.allocatedSize = 23;
	J_.numDimensions = 1;
	J_.canFreeData = false;

	double xgdata[] = { 0.0161, 0.0714, 0.1268, 0.1590, 0.2143, 0.2696, 0.3018, 0.3571, 0.4125, 0.4447, 0.5000,
						0.5553, 0.5875, 0.6429, 0.6982, 0.7304, 0.7857, 0.8410, 0.8732, 0.9286, 0.9839 };
	int xgsize[] = { 21 };
	xg.data = xgdata;
	xg.size = xgsize;
	xg.allocatedSize = 21;
	xg.numDimensions = 1;
	xg.canFreeData = false;

	double wgdata[21];
	for (int i = 0; i < 7; i++) {
		wgdata[i * 3] = 0.0397;
		wgdata[i * 3 + 1] = 0.0635;
		wgdata[i * 3 + 2] = 0.0397;
	}
	int wgsize[] = { 21 };
	wg.data = wgdata;
	wg.size = wgsize;
	wg.allocatedSize = 21;
	wg.numDimensions = 1;
	wg.canFreeData = false;

	double colmatdata[] = { 0.698568501158667,-16.5332650270356,260.865710378498,0.125,-5.25,147,0.00143149884133248,-0.266734972964425,33.1342896215019,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0.283452624903444,14.3665812837945,-383.014993162372,0.59375,-1.3125,-183.75,0.341547375096556,-5.96658128379447,15.5149931623716,0.174642125289667,-4.13331625675889,65.2164275946245,0.03125,-1.3125,36.75,0.000357874710333122,-0.0666837432411064,8.2835724053755,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0.017740290797666,2.1222279144137,116.62690118029,0.260416666666667,5.6875,12.25,0.540593042535667,3.4777720855863,-92.1269011802899,0.596466708944852,-0.0666837432411063,-103.171664387457,0.46875,-3.9375,-36.75,0.228533291055148,-4.1333162567589,29.6716643874572,0.116428083526445,-2.7555441711726,43.4776183964164,0.0208333333333334,-0.875000000000001,24.5,0.000238583140222079,-0.044455828827404,5.52238160358365,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0.00023858314022208,0.0444558288274041,5.52238160358366,0.0208333333333333,0.875,24.5,0.116428083526445,2.7555441711726,43.4776183964163,0.228652582625259,4.1555441711726,32.432855189249,0.479166666666667,4.375,-24.5,0.654680750708075,1.44445582882741,-81.432855189249,0.654680750708075,-1.4444558288274,-81.4328551892491,0.479166666666667,-4.375,-24.5,0.228652582625259,-4.1555441711726,32.4328551892491,0.116428083526445,-2.7555441711726,43.4776183964164,0.0208333333333333,-0.874999999999999,24.5,0.000238583140222081,-0.0444558288274043,5.52238160358367,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0.00023858314022208,0.0444558288274041,5.52238160358366,0.0208333333333333,0.875,24.5,0.116428083526445,2.75554417117259,43.4776183964163,0.228652582625259,4.1555441711726,32.4328551892491,0.479166666666667,4.375,-24.5,0.654680750708075,1.4444558288274,-81.4328551892491,0.654680750708075,-1.4444558288274,-81.4328551892491,0.479166666666667,-4.375,-24.5,0.228652582625259,-4.1555441711726,32.432855189249,0.116428083526445,-2.75554417117259,43.4776183964163,0.0208333333333334,-0.875000000000001,24.5,0.000238583140222081,-0.0444558288274042,5.52238160358366,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.000238583140222079,0.0444558288274039,5.52238160358365,0.0208333333333333,0.874999999999999,24.5,0.116428083526445,2.7555441711726,43.4776183964163,0.228652582625259,4.15554417117259,32.4328551892491,0.479166666666667,4.375,-24.5,0.654680750708075,1.44445582882741,-81.432855189249,0.654680750708075,-1.44445582882741,-81.432855189249,0.479166666666667,-4.375,-24.5,0.228652582625259,-4.1555441711726,32.432855189249,0.116428083526445,-2.7555441711726,43.4776183964164,0.0208333333333334,-0.875000000000002,24.5,0.000238583140222082,-0.0444558288274043,5.52238160358367,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.000238583140222079,0.0444558288274039,5.52238160358365,0.0208333333333334,0.875000000000001,24.5,0.116428083526444,2.75554417117259,43.4776183964163,0.228652582625259,4.1555441711726,32.432855189249,0.479166666666666,4.375,-24.4999999999999,0.654680750708075,1.4444558288274,-81.432855189249,0.654680750708075,-1.4444558288274,-81.4328551892491,0.479166666666667,-4.375,-24.5000000000001,0.228652582625259,-4.1555441711726,32.432855189249,0.116428083526445,-2.7555441711726,43.4776183964163,0.0208333333333334,-0.875000000000001,24.5,0.000238583140222081,-0.0444558288274042,5.52238160358367,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.000238583140222081,0.0444558288274042,5.52238160358367,0.0208333333333333,0.874999999999999,24.5,0.116428083526445,2.7555441711726,43.4776183964163,0.228533291055147,4.13331625675889,29.6716643874573,0.46875,3.93750000000001,-36.7499999999999,0.596466708944852,0.0666837432411116,-103.171664387457,0.540593042535667,-3.4777720855863,-92.1269011802898,0.260416666666667,-5.6875,12.2499999999999,0.0177402907976661,-2.1222279144137,116.62690118029,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.000357874710333115,0.0666837432411055,8.28357240537545,0.0312499999999998,1.3125,36.75,0.174642125289667,4.13331625675889,65.2164275946245,0.341547375096556,5.96658128379447,15.5149931623715,0.59375,1.31250000000001,-183.75,0.283452624903445,-14.3665812837945,-383.014993162371,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00143149884133249,0.266734972964425,33.134289621502,0.125,5.24999999999999,147,0.698568501158667,16.5332650270356,260.865710378498};
	int colmatsize[] = { 63,10 };
	colmat.data = colmatdata;
	colmat.size = colmatsize;
	colmat.allocatedSize = 630;
	colmat.numDimensions = 2;
	colmat.canFreeData = false;

	P0.data = calloc(30, sizeof(double));
	int P0size[] = { 3,10 };
	P0.size = P0size;
	P0.allocatedSize = 30;
	P0.numDimensions = 2;
	P0.canFreeData = false;

	double err;

	SplineApproximation(&gamm_, &J_, 10, &xg, &wg, &colmat, &P0, &err);

	for (int i = 0; i < 10; i++)
		printf("%f\t%f\t%f\n", P0.data[i * 3], P0.data[i * 3+1], P0.data[i * 3+2]);
	printf("error = %f\n", err);

	free(P0.data);

	printf("Hello MATLAB elements test\n");
}